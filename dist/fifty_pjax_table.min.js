!function(e,t){function n(t){function n(e,t){return{order:e+"__"+t,page:1}}function a(){e.pjax({url:R,data:F,push:I,container:A})}function r(){var t=e("#"+E),a=T.find(".ui-pagination");if(K){var r=a.data("current-page"),i=a.data("current-perpage");e.extend(F,{perpage:i}),e.extend(F,{page:r})}var o=t.data("current-sort-property"),c=t.data("current-sort-direction");o?e.extend(F,n(o,c)):delete F.order;var d=t.data("current-search-query");d&&(e.extend(F,{q:d}),$.val(d)),e.extend(F,t.data("custom-filters"))}function i(){M=e("#"+E).find(".table").data("total-rows"),N=T.find("tbody")}function o(){function t(t,n){var a=N.find('td[data-value="'+n+'"]').parent(),r=N.find("tr"),i=r.index(t),o=r.index(a),c=Math.min(i,o),d=Math.max(i,o);r.slice(c,d+1).each(function(){e(this).addClass("ui-selected").children().first().find("input").prop("checked",!0)})}r(),i(),T.on("pjax:timeout",function(e){e.preventDefault()}),T.on("pjax:success",function(e){i(),e.stopPropagation(),T.trigger("load.table")}),T.on("pjax:error",function(e){e.stopPropagation()}),T.on("click",'th[data-sortable="true"]',function(t){var r=e(t.target).closest('th[data-sortable="true"]'),i=r.data("property"),o=z[r.data("current-sort-direction")]||r.data("default-sort-direction");T.trigger("sort.table",{direction:o,property:i}),e.extend(F,n(i,o)),a()}),T.on("click",".ui-perpage-dropdown > li",function(t){var n=e(t.currentTarget).data("value");T.trigger("perpage.table",{perpage:n}),e.extend(F,{perpage:n,page:1}),a()}),T.on("click",".ui-page-select-dropdown > li",function(t){var n=e(t.currentTarget).data("value");T.trigger("page.table",{page:n}),e.extend(F,{page:n}),a()}),T.on("click",".ui-prev-page",function(){var t=parseInt(T.find(".ui-pagination").data("current-page"));T.trigger("prevpage.table",{page:t-1}),e.extend(F,{page:t-1}),a()}),T.on("click",".ui-next-page",function(){var t=parseInt(T.find(".ui-pagination").data("current-page"));T.trigger("nextpage.table",{page:t+1}),e.extend(F,{page:t+1}),a()}),T.on("change",'th[data-select-all-enabled="true"] input[type="checkbox"]',function(){var t=e(this),n=t.parent("th").data("property");t.prop("checked")?(T.find("td[data-property="+n+'] input[type="checkbox"]').prop("checked",!0),N.find("tr").addClass("ui-selected"),T.trigger("select_all.table")):(T.find("td[data-property="+n+'] input[type="checkbox"]').prop("checked",!1),N.find("tr").removeClass("ui-selected"),T.trigger("deselect_all.table"))}),$.keyup(function(t){if(13===t.which){var n=e(this).val();$.trigger("search.table",{query:n}),e.extend(F,{q:n,page:1}),a()}27==t.keyCode&&($.trigger("clear_search.table"),e.extend(F,{q:"",page:1}),a())}),S.on("click",".ui-close",function(){$.val(""),$.trigger("clear_search.table"),e.extend(F,{q:"",page:1}),a()}),T.on("click",'td[data-property="id"]',function(t){e(this).closest("tr").data("shiftKey",t.shiftKey)}),T.on("change",'input[type="checkbox"]',function(){var n=e(this),a=e(this).closest("tr"),r=h(a.get(0)),i=T.data("last_selected");n.prop("checked")?(i&&a.data("shiftKey")&&t(a,i),T.data("last_selected",r.id),a.addClass("ui-selected"),T.trigger("select.table",r)):(T.data("last_selected",null),a.removeClass("ui-selected"),T.find('th[data-select-all-enabled="true"] input[type="checkbox"]').prop("checked",!1),T.trigger("deselect.table",r))}),T.on("click",".tooltip",function(t){e(t.target).tooltip()}),c(),d()}function c(){t.plugins&&j(t.plugins)}function d(){var e,n;if(t.refreshEvents){e=t.refreshEvents.length;for(var a=0;e>a;a++)n=t.refreshEvents[a],n.filter?T.on(n.eventName,n.filter,function(){l()}):T.on(n.eventName,function(){l()})}}function u(e){return p(e),a(),C}function l(){return a(),C}function f(){return R}function p(e){for(var t in e)"undefined"==typeof e[t]||null===e[t]?delete F[t]:F[t]=e[t];return C}function s(t){if(!t)return C;if("string"==typeof t)delete F[t];else if(Array.isArray(t))for(var n=0;n<t.length;n++)delete F[t[n]];else{if("function"!=typeof t)throw new Error("Must provide a string or array");e.each(F,function(e,n){t(e,n)&&delete F[e]})}return C}function g(t){var n=e.extend({},F);return"function"==typeof t&&e.each(n,function(e,a){t(e,a)||delete n[e]}),n}function h(t){var n={additional_fields:{}};return e(t).children().each(function(){var t=e(this),a=t.data();n[a.property]=a.value,e.each(t.data(),function(e,t){"property"!==e&&"value"!==e&&"function"!=typeof t&&"object"!=typeof t&&(n.additional_fields[e]=t)})}),n}function y(e){return N.find("tr").filter(function(){return h(this).id===e?!0:!1}).get(0)}function v(t,n,a){var r,i,o=e(t);e.each(n,function(e,t){r=o.find('td[data-property="'+e+'"]'),r.data(e,t),i=r.data("format"),i&&(t=D[i](t)),r.find(r.data("display-target")).text(t),"function"==typeof a&&a(r,e,t)})}function x(){return N.find("tr").length}function b(){return N.find("tr.ui-selected").length>0}function m(){return N.find("tr.ui-selected").length}function k(e){return N.find("tr.ui-selected").map(function(){return"function"==typeof e?e(h(this)):h(this)}).get()}function w(){return k().map(function(e){return e.id})}function _(){return N.find("tr").map(function(){return h(this)}).get()}function j(t){e.each(t,function(t,n){T.on("click",n.target,function(t){var a=e(t.currentTarget);a.data("plugin-initialized")||(a[n.constructorName](e.extend({},n.options,{queryState:e.extend({},F),record:h(a.closest("tr").get(0))})),a.data("plugin-initialized",!0))})})}function q(e,t,n){v(y(e),t,n)}function P(){return M}var C={},t=t||{},T=e(this),N=null,S=e("#"+(t.search_id||T.data("search_id"))),$=S.find('input[type="search"]'),E=T.data("fifty-table-id"),R=T.data("pjax-url")||window.location.pathname,A=T.data("pjax-container"),I=T.data("push-state-enabled"),K=T.data("paginated"),M=null,z={asc:"desc",desc:"asc"},F={},D={usd:function(e){return numeral(e).format("$0,0.00")},usd_thousandth:function(e){return numeral(e).format("$0,0.000")}};return o(),e.extend(C,{update:u,refresh:l,refreshPlugins:c,getUrl:f,updateParameters:p,removeParameters:s,getParameters:g,getNumRecords:x,hasSelected:b,getNumSelected:m,getSelected:k,getSelectedIds:w,getAllRecords:_,applyPlugins:j,updateRow:q,getTotalRows:P}),C}t.widget("fiftyTable",n)}(jQuery,window.Fifty=window.Fifty||{}),$(function(){$("[data-fifty-table][data-auto-init]").each(function(){$(this).fiftyTable({})})});