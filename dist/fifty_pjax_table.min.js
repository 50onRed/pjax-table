!function(t,e){function n(t){function n(t,e){return{order:t+"__"+e,page:1}}function a(){e.pjax({url:$,data:z,push:I,container:E})}function r(){var t=T.find("#"+M);if(R){var a=t.data("current-page"),r=t.data("current-perpage");e.extend(z,{perpage:r}),e.extend(z,{page:a})}var i=t.data("current-sort-property"),c=t.data("current-sort-direction");i?e.extend(z,n(i,c)):delete z.order,e.extend(z,t.data("custom-filters"))}function i(){A=T.find("#fifty-table").data("total-rows"),C=T.find("tbody")}function c(){function t(t,n){var a=C.find('td[data-value="'+n+'"]').parent(),r=C.find("tr"),i=r.index(t),c=r.index(a),o=Math.min(i,c),d=Math.max(i,c);r.slice(o,d+1).each(function(){e(this).addClass("ui-selected").children().first().find("input").prop("checked",!0)})}r(),i(),T.on("pjax:timeout",function(t){t.preventDefault()}),T.on("pjax:success",function(t){i(),t.stopPropagation(),T.trigger("table.load")}),T.on("pjax:error",function(t){t.stopPropagation()}),T.on("click",'th[data-sortable="true"]',function(t){var r=e(t.target).closest('th[data-sortable="true"]'),i=r.data("property"),c=K[r.data("current-sort-direction")]||r.data("default-sort-direction");e.extend(z,n(i,c)),a(),analytics.track(i,{category:"Table Sort",label:c})}),T.on("click",".ui-perpage-dropdown a",function(t){var n=e(t.target).data("value");e.extend(z,{perpage:n,page:1}),a(),analytics.track("Items Per Page : change",{category:"Pagination",label:z.perpage})}),T.on("click",".ui-page-select-dropdown > li",function(t){var n=e(t.target).data("value");e.extend(z,{page:n}),a(),analytics.track("Go to Page : click",{category:"Pagination",label:z.page})}),T.on("click",".ui-prev-page",function(){var t=parseInt(T.find(".fifty-table-wrapper").data("current-page"));e.extend(z,{page:t-1}),a(),analytics.track("Previous Page : click",{category:"Pagination",label:z.page})}),T.on("click",".ui-next-page",function(){var t=parseInt(T.find(".fifty-table-wrapper").data("current-page"));e.extend(z,{page:t+1}),a(),analytics.track("Next Page : click",{category:"Pagination",label:z.page})}),T.on("change",'th[data-select-all-enabled="true"] input[type="checkbox"]',function(){var t=e(this),n=t.parent("th").data("property");t.prop("checked")?(T.find("td[data-property="+n+'] input[type="checkbox"]').prop("checked",!0),C.find("tr").addClass("ui-selected"),T.trigger("table.select_all")):(T.find("td[data-property="+n+'] input[type="checkbox"]').prop("checked",!1),C.find("tr").removeClass("ui-selected"),T.trigger("table.deselect_all"))}),T.on("click",'td[data-property="id"]',function(t){e(this).closest("tr").data("shiftKey",t.shiftKey)}),T.on("change",'input[type="checkbox"]',function(){var n=e(this),a=e(this).closest("tr"),r=h(a.get(0)),i=T.data("last_selected");n.prop("checked")?(i&&a.data("shiftKey")&&t(a,i),T.data("last_selected",r.id),a.addClass("ui-selected"),T.trigger("table.select",r)):(T.data("last_selected",null),a.removeClass("ui-selected"),T.find('th[data-select-all-enabled="true"] input[type="checkbox"]').prop("checked",!1),T.trigger("table.deselect",r))}),T.on("click",".tooltip",function(t){e(t.target).tooltip()}),o(),d()}function o(){t.plugins&&_(t.plugins)}function d(){var e,n;if(t.refreshEvents){e=t.refreshEvents.length;for(var a=0;e>a;a++)n=t.refreshEvents[a],n.filter?T.on(n.eventName,n.filter,function(){l()}):T.on(n.eventName,function(){l()})}}function u(t){return s(t),a(),S}function l(){return a(),S}function f(){return $}function s(t){for(var e in t)"undefined"==typeof t[e]||null===t[e]?delete z[e]:z[e]=t[e];return S}function p(t){if(!t)return S;if("string"==typeof t)delete z[t];else if(Array.isArray(t))for(var n=0;n<t.length;n++)delete z[t[n]];else{if("function"!=typeof t)throw new Error("Must provide a string or array");e.each(z,function(e,n){t(e,n)&&delete z[e]})}return S}function g(t){var n=e.extend({},z);return"function"==typeof t&&e.each(n,function(e,a){t(e,a)||delete n[e]}),n}function h(t){var n={additional_fields:{}};return e(t).children().each(function(){var t=e(this),a=t.data();n[a.property]=a.value,e.each(t.data(),function(t,e){"property"!==t&&"value"!==t&&"function"!=typeof e&&"object"!=typeof e&&(n.additional_fields[t]=e)})}),n}function y(t){return C.find("tr").filter(function(){return h(this).id===t?!0:!1}).get(0)}function v(t,n,a){var r,i,c=e(t);e.each(n,function(t,e){r=c.find('td[data-property="'+t+'"]'),r.data(t,e),i=r.data("format"),i&&(e=Q[i](e)),r.find(r.data("display-target")).text(e),"function"==typeof a&&a(r,t,e)})}function x(){return C.find("tr").length}function b(){return C.find("tr.ui-selected").length>0}function k(){return C.find("tr.ui-selected").length}function m(t){return C.find("tr.ui-selected").map(function(){return"function"==typeof t?t(h(this)):h(this)}).get()}function P(){return m().map(function(t){return t.id})}function w(){return C.find("tr").map(function(){return h(this)}).get()}function _(t){e.each(t,function(t,n){T.on("click",n.target,function(t){var a=e(t.currentTarget);a.data("plugin-initialized")||(a[n.constructorName](e.extend({},n.options,{queryState:e.extend({},z),record:h(a.closest("tr").get(0))})),a.data("plugin-initialized",!0))})})}function j(t,e,n){v(y(t),e,n)}function N(){return A}var S={},t=t||{},T=e(this),C=null,M=T.data("fifty-table-id"),$=T.data("pjax-url")||window.location.pathname,E=T.data("pjax-container"),I=T.data("push-state-enabled"),R=T.data("paginated"),A=null,K={asc:"desc",desc:"asc"},z={},Q={usd:function(t){return numeral(t).format("$0,0.00")},usd_thousandth:function(t){return numeral(t).format("$0,0.000")}};return c(),e.extend(S,{update:u,refresh:l,refreshPlugins:o,getUrl:f,updateParameters:s,removeParameters:p,getParameters:g,getNumRecords:x,hasSelected:b,getNumSelected:k,getSelected:m,getSelectedIds:P,getAllRecords:w,applyPlugins:_,updateRow:j,getTotalRows:N}),S}e.fn.fiftyTable=t.widget("table",t.util.Mixin(n,t.mixins.TableQueryMixin))}(Fifty,jQuery),$(function(){$("[data-fifty-table][data-auto-init]").each(function(){$(this).fiftyTable({})})});