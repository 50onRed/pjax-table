/*!
 * PJAX Table v2.1.1 ()
 * Copyright 2016
 * 
 */

!function e(t,i,n){function r(s,o){if(!i[s]){if(!t[s]){var l="function"==typeof require&&require;if(!o&&l)return l(s,!0);if(a)return a(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var c=i[s]={exports:{}};t[s][0].call(c.exports,function(e){var i=t[s][1][e];return r(i?i:e)},c,c.exports,e,t,i,n)}return i[s].exports}for(var a="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t,i){"use strict";function n(e,t){r.call(this,e,t),this._formatter=t.formatter||null,this._url=t.url||this._$el.data("url"),this._save=function(e){return"function"==typeof this._formatter&&(e=this._formatter(this._$el,this._record,e)),this._$el.trigger("plugin:before:save"),$.ajax({type:"POST",url:this._url,dataType:"json",contentType:"application/json",data:JSON.stringify(e),context:this}).done(function(e,t,i){"success"===e.status?this._$el.trigger("plugin:save:success",e):this._$el.trigger("plugin:save:error",e)}).fail(function(e,t,i){this._$el.trigger("plugin:save:error",{textStatus:t,errorThrown:i,jqXHR:e})})}}var r=e("./cell_plugin_mixin");"object"==typeof t?t.exports=n:"function"==typeof define?define(function(){return n}):window.AjaxCellMixin=n},{"./cell_plugin_mixin":2}],2:[function(e,t,i){"use strict";function n(e,t){return this._$el=$(e),this._initialQueryState=t.queryState,this._record=t.record,this}"object"==typeof t?t.exports=n:"function"==typeof define?define(function(){return n}):window.CellPluginMixin=n},{}],3:[function(e,t,i){"use strict";function n(e,t){function i(e,t,i){return function(n){t(n,this._$el,this._record,function(){e.call(i,n)})}}this._beforeSave=t.beforeSave||null,"function"==typeof this._save&&"function"==typeof this._beforeSave&&(this._save=i(this._save,this._beforeSave,this))}"object"==typeof t?t.exports=n:"function"==typeof define?define(function(){return n}):window.ConfirmableMixin=n},{}],4:[function(e,t,i){"use strict";function n(e,t){t.url=$(e).find(".ui-select-dropdown").data("url"),r.call(this,e,t),a.call(this,e,t),this._record=t.record,this._requiredFields=this._$el.data("required-fields")?this._$el.data("required-fields").split(","):[],this._init()}var r=e("./ajax_cell_mixin"),a=e("./confirmable_mixin"),s=e("../util/widget");n.prototype._init=function(){this._$el.on("click","[data-dropdown-option]",this._createOnDropdownItemClick.bind(this)),this._$el.on("plugin:save:success",this._onPluginSaveSuccess.bind(this)),this._$el.on("plugin:save:error",this._onPluginSaveError.bind(this))},n.prototype._createOnDropdownItemClick=function(e){var t=$(e.currentTarget),i={};i.id=this._record.id,i[t.data("name")]=t.data("value"),$.each(this._requiredFields,function(e,t){i[t]=this._record.additionalFields[t]}.bind(this));var n={dropdown:this,selectedItem:t,record:i};this._labelToBeUpdated=t.find("a").html(),this._$el.trigger("dropdown:changed",n),n.cancel||this._save(i)},n.prototype._onPluginSaveSuccess=function(e,t){this._$el.find(".dropdown-label").html(this._labelToBeUpdated),this._$el.trigger("message",{status:"success",message:t.message})},n.prototype._onPluginSaveError=function(e,t){this._labelToBeUpdated=null,this._$el.trigger("message",{status:"error",message:t.message})},"object"==typeof t?t.exports=n:"function"==typeof define?define(function(){return n}):window.EditableDropdownPlugin=n,s("editableDropdownPlugin",n)},{"../util/widget":8,"./ajax_cell_mixin":1,"./confirmable_mixin":3}],5:[function(e,t,i){"use strict";function n(e,t){a.call(this,e,t),s.call(this,e,t),this._pk=this._$el.data("pk"),this._$el.on("click",this._onClick.bind(this)),this._onClick()}var r=e("../util/widget"),a=e("./ajax_cell_mixin"),s=e("./confirmable_mixin");n.prototype._onClick=function(e){this._save({pk:this._pk})},"object"==typeof t?t.exports=n:"function"==typeof define?define(function(){return n}):window.RemoveRowPlugin=n,r("removeRowPlugin",n)},{"../util/widget":8,"./ajax_cell_mixin":1,"./confirmable_mixin":3}],6:[function(e,t,i){"use strict";function n(e,t){this._$el=$(e),this._$searchFilter=this._$el.find('input[type="search"]'),this._init()}var r=e("../util/widget");n.prototype._init=function(){this._$el.find(".ui-search").click(this._onClickSearch.bind(this)),this._$el.find(".ui-close").click(this._onClickClose.bind(this)),this._$searchFilter.keyup(this._onInputKeyup.bind(this))},n.prototype._onClickSearch=function(e){this._$el.trigger("search:submit",this._$searchFilter.val())},n.prototype._onInputKeyup=function(e){this._$el.find(".ui-close").removeClass("hidden"),13===e.which?this._$el.trigger("search:submit",$(e.currentTarget).val()):27==e.which&&this._clearSearch()},n.prototype._onClickClose=function(e){this._clearSearch()},n.prototype._clearSearch=function(e){this._$searchFilter.val(""),this._$el.trigger("search:clear"),this._$el.find(".ui-close").addClass("hidden")},"object"==typeof t?t.exports=n:"function"==typeof define?define(function(){return n}):window.PjaxTableSearch=n,r("pjaxTableSearch",n),$(function(){$('[data-pjax-table-search][data-auto-init="true"]').pjaxTableSearch({})})},{"../util/widget":8}],7:[function(e,t,i){"use strict";function n(e,t){this._options=t||{},this._$el=$(e),this._$tbody=null,this._url=this._options.url||this._$el.data("pjax-url")||window.location.pathname,this._ajaxOnly=void 0!==this._options.ajaxOnly?this._options.ajaxOnly:this._$el.data("ajax-only")||!1,this._pushState=void 0!==this._options.pushState?this._options.pushState:this._$el.data("push-state")||!0,this._paginated=void 0!==this._options.paginated?this._options.paginated:this._$el.data("paginated")||!0,this._pjaxContainer=this._options.pjaxContainer||this._$el.data("pjax-container")||this._$el.attr("id"),this._sortQueryKey=this._options.sortQueryKey||this._$el.data("sort-query-key")||"order",this._pageQueryKey=this._options.pageQueryKey||this._$el.data("page-query-key")||"page",this._perPageQueryKey=this._options.perPageQueryKey||this._$el.data("perpage-query-key")||"perpage",this._searchQueryKey=this._options.searchQueryKey||this._$el.data("search-query-key")||"q",this._querySyncFn=this._options.querySyncFn||null,this._totalRows=null;var i=this._options.searchId||this._$el.data("search-id")||null;this._$searchBox=i?$(i):null,this._sortMap={asc:"desc",desc:"asc"},this._queryState=$.extend({},this._options.queryState),this._init()}var r=e("./util/widget"),a=e("./cell_plugins/cell_plugin_mixin"),s=e("./cell_plugins/ajax_cell_mixin"),o=e("./cell_plugins/confirmable_mixin"),l=e("./cell_plugins/editable_dropdown"),h=e("./cell_plugins/remove_row"),c=e("./external_plugins/search_box");$.extend(n.prototype,{_createSortQuery:function(e,t){var i={};return i[this._sortQueryKey]=e+"__"+t,i},_desyncSort:function(){delete this._queryState[this._sortQueryKey]},_createPageQuery:function(e){var t={};return t[this._pageQueryKey]=e,t},_createPerPageQuery:function(e){var t={};return t[this._perPageQueryKey]=e,t},_createSearchQuery:function(e){var t={};return t[this._searchQueryKey]=e,t},_desyncSearch:function(){delete this._queryState[this._searchQueryKey]},_syncSort:function(e,t){$.extend(this._queryState,this._createSortQuery(e,t))},_syncPage:function(e){$.extend(this._queryState,this._createPageQuery(e))},_syncPerPage:function(e){$.extend(this._queryState,this._createPerPageQuery(e))},_syncSearch:function(e){$.extend(this._queryState,this._createSearchQuery(e))},_load:function(e){return!this._ajaxOnly&&$.support.pjax?$.pjax($.extend({url:this._url,data:this._queryState,push:this._pushState,container:this._pjaxContainer},e)):(this._addLoadMask(),$.ajax($.extend({type:"GET",url:this._url,data:this._queryState,context:this},e)).done(this._onAjaxSuccess).fail(this._onAjaxError))},_addLoadMask:function(){var e=$('<div class="ui-load-mask">');this._$el.css({position:"relative"}),this._$el.append(e),e.spin(this._options.loadMaskConfig||"small")},_removeLoadMask:function(){this._$el.find(".ui-load-mask").remove(),this._$el.css({position:""})},_syncQueryState:function(){var e=this._$el.find("table"),t=e.data("current-page"),i=e.data("current-perpage"),n=e.data("current-sort-property"),r=e.data("current-sort-direction"),a=e.data("current-search-str");this._paginated&&(this._syncPage(t),this._syncPerPage(i)),n?this._syncSort(n,r):this._desyncSort(),a?this._syncSearch(a):this._desyncSearch(),"function"==typeof this._querySyncFn&&$.extend(this._queryState,this._querySyncFn(e))},_onTableLoaded:function(){this._$tbody=this._$el.find("tbody");var e=this._$el.find("table").data("total-rows");this._totalRows=0|e,this._$el.trigger("table:load")},_onAjaxSuccess:function(e,t,i){this._$el.html(e),this._onTableLoaded(),this._removeLoadMask()},_onAjaxError:function(e,t,i){this._removeLoadMask(),this._$el.trigger("table:error")},_onPjaxStart:function(e){this._addLoadMask()},_onPjaxBeforeReplace:function(e){e.stopPropagation(),this._removeLoadMask()},_onPjaxTimeout:function(e){e.preventDefault(),this._$el.trigger("table:timeout")},_onPjaxSuccess:function(e,t,i,n,r){this._onTableLoaded(),e.stopPropagation()},_onPjaxError:function(e,t,i,n,r){return e.stopPropagation(),e.preventDefault(),this._removeLoadMask(),"abort"===n?this._$el.trigger("table:cancelled"):void this._$el.trigger("table:error")},_onClickSortable:function(e){var t=$(e.target).closest('th[data-sortable="true"]'),i=t.data("property"),n=this._sortMap[t.data("current-sort-direction")]||t.data("default-sort-direction");this._$el.trigger("table:sort",this._createSortQuery(i,n)),this._syncSort(i,n),this._syncPage(1),this._load()},_onPerPageSelect:function(e){var t=$(e.currentTarget).data("value");this._$el.trigger("table:perpage",this._createPerPageQuery(t)),this._syncPerPage(t),this._syncPage(1),this._load()},_onPageSelect:function(e){var t=$(e.currentTarget).data("value");this._$el.trigger("table:page",this._createPageQuery(t)),this._syncPage(t),this._load()},_onPrevPageSelect:function(e){var t=parseInt(this._$el.find("table").data("current-page")),i=Math.max(1,t-1);this._$el.trigger("table:prevpage",this._createPageQuery(i)),this._syncPage(i),this._load()},_onNextPageSelect:function(e){var t=parseInt(this._$el.find("table").data("current-page")),i=t+1;this._$el.trigger("table:nextpage",this._createPageQuery(i)),this._syncPage(i),this._load()},_onHeaderCheckboxChange:function(e){var t=$(e.currentTarget),i=t.parent("th").data("property");this._disableRowCheckboxChangeHandling(),t.prop("checked")?(this._$el.find("td[data-property="+i+'] input[type="checkbox"]').prop("checked",!0),this._$tbody.find("tr").addClass("ui-selected"),this._$el.trigger("table:select:all")):(this._$el.find("td[data-property="+i+'] input[type="checkbox"]').prop("checked",!1),this._$tbody.find("tr").removeClass("ui-selected"),this._$el.trigger("table:deselect:all")),this._enableRowCheckboxChangeHandling()},_onClickIdColumn:function(e){$(this).closest("tr").data("shiftKey",e.shiftKey)},_onRowCheckboxChange:function(e){var t=$(e.currentTarget),i=$(e.currentTarget).closest("tr"),n=this._getRecord(i.get(0)),r=this._$el.data("last_selected");r&&i.data("shiftKey")&&(this._disableRowCheckboxChangeHandling(),this._shiftSelectRows(i,r),this._enableRowCheckboxChangeHandling()),this._$el.data("last_selected",n.id),t.prop("checked")?(i.addClass("ui-selected"),this._$el.trigger("table:select",n)):(i.removeClass("ui-selected"),this._$el.find('th[data-select-all-enabled="true"] input[type="checkbox"]').prop("checked",!1),this._$el.trigger("table:deselect",n))},_shiftSelectRows:function(e,t){var i=this._$tbody.find('td[data-property="id"][data-value="'+t+'"]').parent(),n=this._$tbody.find("tr"),r=n.index(e),a=n.index(i),s=Math.min(r,a),o=Math.max(r,a);r>a&&i.hasClass("ui-selected")&&++s,++o,n.slice(s,o).each(function(){var e=$(this);i.hasClass("ui-selected")?e.addClass("ui-selected").children().first().find("input").prop("checked",!0):e.removeClass("ui-selected").children().first().find("input").prop("checked",!1)}),this._$el.trigger("table:shiftselect")},_onSubmitSearch:function(e,t){this._$el.trigger("table:search",this._createSearchQuery(t)),this._syncSearch(t),this._syncPage(1),this._load()},_onClearSearch:function(e){this._$el.trigger("table:search:clear"),this._desyncSearch(),this._syncPage(1),this._load()},_applyPlugins:function(e){$.each(e,function(e,t){this._$el.on("click",t.target,function(e){var i=$(e.currentTarget);i.data("plugin-initialized")||(i[t.constructorName]($.extend({},t.options,{queryState:$.extend({},this._queryState),record:this._getRecord(i.closest("tr").get(0)),event:e})),i.data("plugin-initialized",!0))}.bind(this))}.bind(this))},_onPluginRefreshEvent:function(e){this.refresh()},_initPluginRefreshEvents:function(){var e,t;if(this._options.refreshEvents){e=this._options.refreshEvents.length;for(var i=0;e>i;i++)t=this._options.refreshEvents[i],t.filter?this._$el.on(t.eventName,t.filter,this._onPluginRefreshEvent.bind(this)):this._$el.on(t.eventName,this._onPluginRefreshEvent.bind(this))}},_enableRowCheckboxChangeHandling:function(){this._checkboxChangeHandler=this._onRowCheckboxChange.bind(this),this._$el.on("change",'td[data-property="id"] input[type="checkbox"]',this._checkboxChangeHandler)},_disableRowCheckboxChangeHandling:function(){this._$el.off("change",'td[data-property="id"] input[type="checkbox"]',this._checkboxChangeHandler),this._checkboxChangeHandler=null},_init:function(){this._syncQueryState(),this._onTableLoaded(),this._$el.on("pjax:timeout",this._onPjaxTimeout.bind(this)),this._$el.on("pjax:success",this._onPjaxSuccess.bind(this)),this._$el.on("pjax:start",this._onPjaxStart.bind(this)),this._$el.on("pjax:beforeReplace",this._onPjaxBeforeReplace.bind(this)),this._$el.on("pjax:error",this._onPjaxError.bind(this)),this._$el.on("click",'th[data-sortable="true"]',this._onClickSortable.bind(this)),this._$el.on("click",".ui-perpage-dropdown > li",this._onPerPageSelect.bind(this)),this._$el.on("click",".ui-page-select-dropdown > li",this._onPageSelect.bind(this)),this._$el.on("click",".ui-prev-page",this._onPrevPageSelect.bind(this)),this._$el.on("click",".ui-next-page",this._onNextPageSelect.bind(this)),this._$el.on("change",'th[data-select-all-enabled="true"] input[type="checkbox"]',this._onHeaderCheckboxChange.bind(this)),this._enableRowCheckboxChangeHandling(),this._$el.on("click",'td[data-property="id"]',this._onClickIdColumn.bind(this)),this._$searchBox&&(this._$searchBox.on("search:submit",this._onSubmitSearch.bind(this)),this._$searchBox.on("search:clear",this._onClearSearch.bind(this))),this.refreshPlugins(),this._initPluginRefreshEvents()},_getRecord:function(e){var t={additionalFields:{}};return $(e).children().each(function(){var e=$(this),i=e.data();t[i.property]=i.value,$.each(e.data(),function(e,i){"property"!==e&&"value"!==e&&"function"!=typeof i&&"object"!=typeof i&&(t.additionalFields[e]=i)})}),t},_findRowById:function(e){return this._$tbody.find("tr").filter(function(t,i){return this._getRecord(i).id===e?!0:!1}.bind(this)).get(0)},_updateRowFields:function(e,t,i){var n=$(e);$.each(t,function(e,t){var r=n.find('td[data-property="'+e+'"]');r.data("value",t),r.find(r.data("display-target")).text(t),"function"==typeof i&&i(r,e,t)})},refreshPlugins:function(){this._options.plugins&&this._applyPlugins(this._options.plugins)},update:function(e,t){return this.updateParameters(e),this._load(t),this},load:function(e){return this._load(e),this},refresh:function(){return this._load(),this},getUrl:function(){return this._url},updateParameters:function(e){for(var t in e)"undefined"==typeof e[t]||null===e[t]?delete this._queryState[t]:this._queryState[t]=e[t];return this},removeParameters:function(e){if(!e||Array.isArray(e)&&!e.length)return this;if("string"==typeof e)delete this._queryState[e];else if(Array.isArray(e))for(var t=0;t<e.length;t++)delete this._queryState[e[t]];else"function"==typeof e&&$.each(this._queryState,function(t,i){e(t,i)&&delete this._queryState[t]}.bind(this));return this},getParameters:function(e){var t=$.extend({},this._queryState);return"function"==typeof e&&$.each(t,function(i,n){e(i,n)||delete t[i]}),t},getNumRecords:function(){return this._$tbody.find("tr").length},getNumColumns:function(){return this._$el.find("thead tr").children().length},hasSelectedRecords:function(){return this._$tbody.find("tr.ui-selected").length>0},getNumSelectedRecords:function(){return this._$tbody.find("tr.ui-selected").length},getSelectedRecords:function(e){return this._$tbody.find("tr.ui-selected").map(function(t,i){return"function"==typeof e?e(this._getRecord(i)):this._getRecord(i)}.bind(this)).get()},getSelectedRecordIds:function(){return this.getSelectedRecords(function(e){return e.id})},getRecords:function(){return this._$tbody.find("tr").map(function(e,t){return this._getRecord(t)}.bind(this)).get()},updateRow:function(e,t,i){this._updateRowFields(this._findRowById(e),t,i)},getNumTotalRows:function(){return this._totalRows}}),"object"==typeof t?t.exports=n:"function"==typeof define&&define(function(){return n}),window.PjaxTable=n,window.PjaxTableShared={CellPluginMixin:a,AjaxCellMixin:s,ConfirmableMixin:o,EditableDropdownPlugin:l,RemoveRowPlugin:h,SearchBox:c},r("pjaxTable",n),$(function(){$("[data-pjax-table][data-auto-init]").pjaxTable(window.PjaxTableConfig=window.PjaxTableConfig||{})})},{"./cell_plugins/ajax_cell_mixin":1,"./cell_plugins/cell_plugin_mixin":2,"./cell_plugins/confirmable_mixin":3,"./cell_plugins/editable_dropdown":4,"./cell_plugins/remove_row":5,"./external_plugins/search_box":6,"./util/widget":8}],8:[function(e,t,i){"use strict";function n(e,t){function i(e){var i=r.call(arguments),n=[];return $(this).each(function(){var r,a=$(this),s=a.data(o);if(s||(s=a.data(o,new t(this,e)).data(o)),"string"==typeof e)if("destroy"===e)"function"==typeof s.destroy&&s.destroy(),delete a.data()[o];else{if("function"!=typeof s[e]||"_"===e.charAt(0))throw new Error("Invalid method: "+e);r=s[e].apply(s,i.slice(1,i.length)),n.push(r)}else n.push(s)}),n.length>1?n:n[0]}var n,a=$,s=e.split("."),o=s.pop();s.length||(s=["PjaxTable","widget"]),n=s.length;for(var l=0;n>l;l++)a[s[l]]||(a[s[l]]={}),a=a[s[l]];return $.fn[o]||($.fn[o]=i),a[o]=i,i}var r=Array.prototype.slice;t.exports=n},{}]},{},[7]);