/*!
 * PJAX Table v1.5.2 ()
 * Copyright 2015
 * 
 */

!function t(e,i,n){function a(s,o){if(!i[s]){if(!e[s]){var h="function"==typeof require&&require;if(!o&&h)return h(s,!0);if(r)return r(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[s]={exports:{}};e[s][0].call(c.exports,function(t){var i=e[s][1][t];return a(i?i:t)},c,c.exports,t,e,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)a(n[s]);return a}({1:[function(t,e,i){"use strict";function n(t,e){a.call(this,t,e),this._url=e.url||this._$el.data("url"),this._save=function(t){return this._$el.trigger("plugin:before:save"),$.ajax({type:"POST",url:this._url,dataType:"json",contentType:"application/json",data:JSON.stringify(t),context:this}).done(function(t,e,i){"success"===t.status?this._$el.trigger("plugin:save:success",t):this._$el.trigger("plugin:save:error",t)}).fail(function(t,e,i){this._$el.trigger("plugin:save:error",{textStatus:e,errorThrown:i,jqXHR:t})})}}var a=t("./cell_plugin_mixin");"object"==typeof e?e.exports=n:"function"==typeof define?define(function(){return n}):window.AjaxCellMixin=n},{"./cell_plugin_mixin":2}],2:[function(t,e,i){"use strict";function n(t,e){return this._$el=$(t),this._initialQueryState=e.queryState,this._record=e.record,this}"object"==typeof e?e.exports=n:"function"==typeof define?define(function(){return n}):window.CellPluginMixin=n},{}],3:[function(t,e,i){"use strict";function n(t,e){e.url=$(t).find(".ui-select-dropdown").data("url"),a.call(this,t,e),this._record=e.record,this._requiredFields=this._$el.data("required-fields")?this._$el.data("required-fields").split(","):[],this._init()}var a=t("./ajax_cell_mixin"),r=t("../util/widget");n.prototype._init=function(){this._$el.on("click","[data-dropdown-option]",this._createOnDropdownItemClick.bind(this)),this._$el.on("plugin:save:success",this._onPluginSaveSuccess.bind(this)),this._$el.on("plugin:save:error",this._onPluginSaveError.bind(this))},n.prototype._createOnDropdownItemClick=function(t){var e=$(t.currentTarget),i={};i.id=this._record.id,i[e.data("name")]=e.data("value"),$.each(this._requiredFields,function(t,e){i[e]=this._record.additionalFields[e]}.bind(this));var n={dropdown:this,selectedItem:e,record:i};this._$el.trigger("dropdown:changed",n),n.cancel||this._saveChanges(e,i)},n.prototype._saveChanges=function(t,e){this._updateLabel(t),this._save(e)},n.prototype._updateLabel=function(t){var e=this._$el.find(".dropdown-label"),i=t.find("a").html();e.html(i)},n.prototype._onPluginSaveSuccess=function(t,e){this._$el.trigger("message",{status:"success",message:e.message})},n.prototype._onPluginSaveError=function(t,e){this._$el.trigger("message",{status:"error",message:e.message})},"object"==typeof e?e.exports=n:"function"==typeof define?define(function(){return n}):window.EditableDropdownPlugin=n,r("editableDropdownPlugin",n)},{"../util/widget":7,"./ajax_cell_mixin":1}],4:[function(t,e,i){"use strict";function n(t,e){r.call(this,t,e),this._pk=this._$el.data("pk"),this._init()}var a=t("../util/widget"),r=t("./ajax_cell_mixin");n.prototype._init=function(){this._onClick()},n.prototype._onClick=function(t){this._save({pk:this._pk})},"object"==typeof e?e.exports=n:"function"==typeof define?define(function(){return n}):window.RemoveRowPlugin=n,a("removeRowPlugin",n)},{"../util/widget":7,"./ajax_cell_mixin":1}],5:[function(t,e,i){"use strict";function n(t,e){this._$el=$(t),this._$searchFilter=this._$el.find('input[type="search"]'),this._init()}var a=t("../util/widget");n.prototype._init=function(){this._$el.find(".ui-search").click(this._onClickSearch.bind(this)),this._$el.find(".ui-close").click(this._onClickClose.bind(this)),this._$searchFilter.keyup(this._onInputKeyup.bind(this))},n.prototype._onClickSearch=function(t){this._$el.trigger("search:submit",this._$searchFilter.val())},n.prototype._onInputKeyup=function(t){this._$el.find(".ui-close").removeClass("hidden"),13===t.which?this._$el.trigger("search:submit",$(t.currentTarget).val()):27==t.which&&this._clearSearch()},n.prototype._onClickClose=function(t){this._clearSearch()},n.prototype._clearSearch=function(t){this._$searchFilter.val(""),this._$el.trigger("search:clear"),this._$el.find(".ui-close").addClass("hidden")},"object"==typeof e?e.exports=n:"function"==typeof define?define(function(){return n}):window.PjaxTableSearch=n,a("pjaxTableSearch",n),$(function(){$('[data-pjax-table-search][data-auto-init="true"]').pjaxTableSearch({})})},{"../util/widget":7}],6:[function(t,e,i){"use strict";function n(t,e){this._options=e||{},this._$el=$(t),this._$tbody=null,this._url=this._options.url||this._$el.data("pjax-url")||window.location.pathname,this._ajaxOnly=void 0!==this._options.ajaxOnly?this._options.ajaxOnly:this._$el.data("ajax-only")||!1,this._pushState=void 0!==this._options.pushState?this._options.pushState:this._$el.data("push-state")||!0,this._paginated=void 0!==this._options.paginated?this._options.paginated:this._$el.data("paginated")||!0,this._pjaxContainer=this._options.pjaxContainer||this._$el.data("pjax-container")||this._$el.attr("id"),this._noDataTemplate=this._options.noDataTemplate||this._noDataTemplate,this._sortQueryKey=this._options.sortQueryKey||this._$el.data("sort-query-key")||"order",this._pageQueryKey=this._options.pageQueryKey||this._$el.data("page-query-key")||"page",this._perPageQueryKey=this._options.perPageQueryKey||this._$el.data("perpage-query-key")||"perpage",this._searchQueryKey=this._options.searchQueryKey||this._$el.data("search-query-key")||"q",this._querySyncFn=this._options.querySyncFn||null,this._totalRows=null;var i=this._options.searchId||this._$el.data("search-id")||null;this._$searchBox=i?$(i):null,this._sortMap={asc:"desc",desc:"asc"},this._queryState=$.extend({},this._options.queryState),this._init()}var a=t("./util/widget"),r=t("./cell_plugins/cell_plugin_mixin"),s=t("./cell_plugins/ajax_cell_mixin"),o=t("./cell_plugins/editable_dropdown"),h=t("./cell_plugins/remove_row"),l=t("./external_plugins/search_box");$.extend(n.prototype,{_noDataTemplate:function(t){return["<tr>",'<td class="empty-table-content" colspan="'+t+'">',"Whoops! Looks like there's nothing in this table!","</td>","</tr>"].join("")},_createSortQuery:function(t,e){var i={};return i[this._sortQueryKey]=t+"__"+e,i},_desyncSort:function(){delete this._queryState[this._sortQueryKey]},_createPageQuery:function(t){var e={};return e[this._pageQueryKey]=t,e},_createPerPageQuery:function(t){var e={};return e[this._perPageQueryKey]=t,e},_createSearchQuery:function(t){var e={};return e[this._searchQueryKey]=t,e},_desyncSearch:function(){delete this._queryState[this._searchQueryKey]},_syncSort:function(t,e){$.extend(this._queryState,this._createSortQuery(t,e))},_syncPage:function(t){$.extend(this._queryState,this._createPageQuery(t))},_syncPerPage:function(t){$.extend(this._queryState,this._createPerPageQuery(t))},_syncSearch:function(t){$.extend(this._queryState,this._createSearchQuery(t))},_load:function(t){return this._ajaxOnly?(this._addLoadMask(),$.ajax($.extend({type:"GET",url:this._url,data:this._queryState,context:this},t)).done(this._onAjaxSuccess).fail(this._onAjaxError)):$.pjax($.extend({url:this._url,data:this._queryState,push:this._pushState,container:this._pjaxContainer},t))},_addLoadMask:function(){var t=$('<div class="ui-load-mask">');this._$el.css({position:"relative"}),this._$el.append(t),t.spin(this._options.loadMaskConfig||"small")},_removeLoadMask:function(){this._$el.find(".ui-load-mask").remove(),this._$el.css({position:""})},_syncQueryState:function(){var t=this._$el.find("table"),e=t.data("current-page"),i=t.data("current-perpage"),n=t.data("current-sort-property"),a=t.data("current-sort-direction"),r=t.data("current-search-str");this._paginated&&(this._syncPage(e),this._syncPerPage(i)),n?this._syncSort(n,a):this._desyncSort(),r?this._syncSearch(r):this._desyncSearch(),"function"==typeof this._querySyncFn&&$.extend(this._queryState,this._querySyncFn(t))},_onTableLoaded:function(){this._$tbody=this._$el.find("tbody");var t=this._$el.find("table").data("total-rows");this._totalRows=0|t,0===this._totalRows&&this._$tbody.html(this._noDataTemplate(this.getNumColumns())),this._$el.trigger("table:load")},_onAjaxSuccess:function(t,e,i){this._$el.html(t),this._onTableLoaded(),this._removeLoadMask()},_onAjaxError:function(t,e,i){this._removeLoadMask(),this._$el.trigger("table:error")},_onPjaxStart:function(t){this._addLoadMask()},_onPjaxBeforeReplace:function(t){t.stopPropagation(),this._removeLoadMask()},_onPjaxTimeout:function(t){t.preventDefault(),this._$el.trigger("table:timeout")},_onPjaxSuccess:function(t,e,i,n,a){this._onTableLoaded(),t.stopPropagation()},_onPjaxError:function(t,e,i,n,a){t.stopPropagation(),t.preventDefault(),this._removeLoadMask(),this._$el.trigger("table:error")},_onClickSortable:function(t){var e=$(t.target).closest('th[data-sortable="true"]'),i=e.data("property"),n=this._sortMap[e.data("current-sort-direction")]||e.data("default-sort-direction");this._$el.trigger("table:sort",this._createSortQuery(i,n)),this._syncSort(i,n),this._syncPage(1),this._load()},_onPerPageSelect:function(t){var e=$(t.currentTarget).data("value");this._$el.trigger("table:perpage",this._createPerPageQuery(e)),this._syncPerPage(e),this._syncPage(1),this._load()},_onPageSelect:function(t){var e=$(t.currentTarget).data("value");this._$el.trigger("table:page",this._createPageQuery(e)),this._syncPage(e),this._load()},_onPrevPageSelect:function(t){var e=parseInt(this._$el.find("table").data("current-page")),i=Math.max(1,e-1);this._$el.trigger("table:prevpage",this._createPageQuery(i)),this._syncPage(i),this._load()},_onNextPageSelect:function(t){var e=parseInt(this._$el.find("table").data("current-page")),i=e+1;this._$el.trigger("table:nextpage",this._createPageQuery(i)),this._syncPage(i),this._load()},_onHeaderCheckboxChange:function(t){var e=$(t.currentTarget),i=e.parent("th").data("property");this._disableRowCheckboxChangeHandling(),e.prop("checked")?(this._$el.find("td[data-property="+i+'] input[type="checkbox"]').prop("checked",!0),this._$tbody.find("tr").addClass("ui-selected"),this._$el.trigger("table:select:all")):(this._$el.find("td[data-property="+i+'] input[type="checkbox"]').prop("checked",!1),this._$tbody.find("tr").removeClass("ui-selected"),this._$el.trigger("table:deselect:all")),this._enableRowCheckboxChangeHandling()},_onClickIdColumn:function(t){$(this).closest("tr").data("shiftKey",t.shiftKey)},_onRowCheckboxChange:function(t){var e=$(t.currentTarget),i=$(t.currentTarget).closest("tr"),n=this._getRecord(i.get(0)),a=this._$el.data("last_selected");a&&i.data("shiftKey")&&(this._disableRowCheckboxChangeHandling(),this._shiftSelectRows(i,a),this._enableRowCheckboxChangeHandling()),this._$el.data("last_selected",n.id),e.prop("checked")?(i.addClass("ui-selected"),this._$el.trigger("table:select",n)):(i.removeClass("ui-selected"),this._$el.find('th[data-select-all-enabled="true"] input[type="checkbox"]').prop("checked",!1),this._$el.trigger("table:deselect",n))},_shiftSelectRows:function(t,e){var i=this._$tbody.find('td[data-property="id"][data-value="'+e+'"]').parent(),n=this._$tbody.find("tr"),a=n.index(t),r=n.index(i),s=Math.min(a,r),o=Math.max(a,r);a>r&&i.hasClass("ui-selected")&&++s,++o,n.slice(s,o).each(function(){var t=$(this);i.hasClass("ui-selected")?t.addClass("ui-selected").children().first().find("input").prop("checked",!0):t.removeClass("ui-selected").children().first().find("input").prop("checked",!1)}),this._$el.trigger("table:shiftselect")},_onSubmitSearch:function(t,e){this._$el.trigger("table:search",this._createSearchQuery(e)),this._syncSearch(e),this._syncPage(1),this._load()},_onClearSearch:function(t){this._$el.trigger("table:search:clear"),this._desyncSearch(),this._syncPage(1),this._load()},_applyPlugins:function(t){$.each(t,function(t,e){this._$el.on("click",e.target,function(t){var i=$(t.currentTarget);i.data("plugin-initialized")||(i[e.constructorName]($.extend({},e.options,{queryState:$.extend({},this._queryState),record:this._getRecord(i.closest("tr").get(0)),event:t})),i.data("plugin-initialized",!0))}.bind(this))}.bind(this))},_onPluginRefreshEvent:function(t){this.refresh()},_initPluginRefreshEvents:function(){var t,e;if(this._options.refreshEvents){t=this._options.refreshEvents.length;for(var i=0;t>i;i++)e=this._options.refreshEvents[i],e.filter?this._$el.on(e.eventName,e.filter,this._onPluginRefreshEvent.bind(this)):this._$el.on(e.eventName,this._onPluginRefreshEvent.bind(this))}},_enableRowCheckboxChangeHandling:function(){this._checkboxChangeHandler=this._onRowCheckboxChange.bind(this),this._$el.on("change",'td[data-property="id"] input[type="checkbox"]',this._checkboxChangeHandler)},_disableRowCheckboxChangeHandling:function(){this._$el.off("change",'td[data-property="id"] input[type="checkbox"]',this._checkboxChangeHandler),this._checkboxChangeHandler=null},_init:function(){this._syncQueryState(),this._onTableLoaded(),this._$el.on("pjax:timeout",this._onPjaxTimeout.bind(this)),this._$el.on("pjax:success",this._onPjaxSuccess.bind(this)),this._$el.on("pjax:start",this._onPjaxStart.bind(this)),this._$el.on("pjax:beforeReplace",this._onPjaxBeforeReplace.bind(this)),this._$el.on("pjax:error",this._onPjaxError.bind(this)),this._$el.on("click",'th[data-sortable="true"]',this._onClickSortable.bind(this)),this._$el.on("click",".ui-perpage-dropdown > li",this._onPerPageSelect.bind(this)),this._$el.on("click",".ui-page-select-dropdown > li",this._onPageSelect.bind(this)),this._$el.on("click",".ui-prev-page",this._onPrevPageSelect.bind(this)),this._$el.on("click",".ui-next-page",this._onNextPageSelect.bind(this)),this._$el.on("change",'th[data-select-all-enabled="true"] input[type="checkbox"]',this._onHeaderCheckboxChange.bind(this)),this._enableRowCheckboxChangeHandling(),this._$el.on("click",'td[data-property="id"]',this._onClickIdColumn.bind(this)),this._$searchBox&&(this._$searchBox.on("search:submit",this._onSubmitSearch.bind(this)),this._$searchBox.on("search:clear",this._onClearSearch.bind(this))),this.refreshPlugins(),this._initPluginRefreshEvents()},_getRecord:function(t){var e={additionalFields:{}};return $(t).children().each(function(){var t=$(this),i=t.data();e[i.property]=i.value,$.each(t.data(),function(t,i){"property"!==t&&"value"!==t&&"function"!=typeof i&&"object"!=typeof i&&(e.additionalFields[t]=i)})}),e},_findRowById:function(t){return this._$tbody.find("tr").filter(function(e,i){return this._getRecord(i).id===t?!0:!1}.bind(this)).get(0)},_updateRowFields:function(t,e,i){var n=$(t);$.each(e,function(t,e){var a=n.find('td[data-property="'+t+'"]');a.data("value",e),a.find(a.data("display-target")).text(e),"function"==typeof i&&i(a,t,e)})},refreshPlugins:function(){this._options.plugins&&this._applyPlugins(this._options.plugins)},update:function(t,e){return this.updateParameters(t),this._load(e),this},load:function(t){return this._load(t),this},refresh:function(){return this._load(),this},getUrl:function(){return this._url},updateParameters:function(t){for(var e in t)"undefined"==typeof t[e]||null===t[e]?delete this._queryState[e]:this._queryState[e]=t[e];return this},removeParameters:function(t){if(!t||Array.isArray(t)&&!t.length)return this;if("string"==typeof t)delete this._queryState[t];else if(Array.isArray(t))for(var e=0;e<t.length;e++)delete this._queryState[t[e]];else"function"==typeof t&&$.each(this._queryState,function(e,i){t(e,i)&&delete this._queryState[e]}.bind(this));return this},getParameters:function(t){var e=$.extend({},this._queryState);return"function"==typeof t&&$.each(e,function(i,n){t(i,n)||delete e[i]}),e},getNumRecords:function(){return this._$tbody.find("tr").length},getNumColumns:function(){return this._$el.find("thead tr").children().length},hasSelectedRecords:function(){return this._$tbody.find("tr.ui-selected").length>0},getNumSelectedRecords:function(){return this._$tbody.find("tr.ui-selected").length},getSelectedRecords:function(t){return this._$tbody.find("tr.ui-selected").map(function(e,i){return"function"==typeof t?t(this._getRecord(i)):this._getRecord(i)}.bind(this)).get()},getSelectedRecordIds:function(){return this.getSelectedRecords(function(t){return t.id})},getRecords:function(){return this._$tbody.find("tr").map(function(t,e){return this._getRecord(e)}.bind(this)).get()},updateRow:function(t,e,i){this._updateRowFields(this._findRowById(t),e,i)},getNumTotalRows:function(){return this._totalRows}}),"object"==typeof e?e.exports=n:"function"==typeof define&&define(function(){return n}),window.PjaxTable=n,window.PjaxTableShared={CellPluginMixin:r,AjaxCellMixin:s,EditableDropdownPlugin:o,RemoveRowPlugin:h,SearchBox:l},a("pjaxTable",n),$(function(){$("[data-pjax-table][data-auto-init]").pjaxTable(window.PjaxTableConfig=window.PjaxTableConfig||{})})},{"./cell_plugins/ajax_cell_mixin":1,"./cell_plugins/cell_plugin_mixin":2,"./cell_plugins/editable_dropdown":3,"./cell_plugins/remove_row":4,"./external_plugins/search_box":5,"./util/widget":7}],7:[function(t,e,i){"use strict";function n(t,e){function i(t){var i=a.call(arguments),n=[];return $(this).each(function(){var a,r=$(this),s=r.data(o);if(s||(s=r.data(o,new e(this,t)).data(o)),"string"==typeof t)if("destroy"===t)"function"==typeof s.destroy&&s.destroy(),delete r.data()[o];else{if("function"!=typeof s[t]||"_"===t.charAt(0))throw new Error("Invalid method: "+t);a=s[t].apply(s,i.slice(1,i.length)),n.push(a)}else n.push(s)}),n.length>1?n:n[0]}var n,r=$,s=t.split("."),o=s.pop();s.length||(s=["PjaxTable","widget"]),n=s.length;for(var h=0;n>h;h++)r[s[h]]||(r[s[h]]={}),r=r[s[h]];return $.fn[o]||($.fn[o]=i),r[o]=i,i}var a=Array.prototype.slice;e.exports=n},{}]},{},[6]);